<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TheSeeker Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="game-design.html"><strong aria-hidden="true">1.</strong> Game Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="game-design/audience.html"><strong aria-hidden="true">1.1.</strong> Target Audience</a></li><li class="chapter-item expanded "><a href="game-design/monetization.html"><strong aria-hidden="true">1.2.</strong> Monetization</a></li><li class="chapter-item expanded "><a href="game-design/art-direction.html"><strong aria-hidden="true">1.3.</strong> Art Direction</a></li><li class="chapter-item expanded "><a href="game-design/lore.html"><strong aria-hidden="true">1.4.</strong> Game Lore</a></li><li class="chapter-item expanded "><a href="game-design/game-mechanics.html"><strong aria-hidden="true">1.5.</strong> Gameplay / Mechanics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="game-design/game-mechanics/active-skills.html"><strong aria-hidden="true">1.5.1.</strong> Active Skills</a></li><li class="chapter-item expanded "><a href="game-design/game-mechanics/passive-skills.html"><strong aria-hidden="true">1.5.2.</strong> Passive Skills</a></li><li class="chapter-item expanded "><a href="game-design/game-mechanics/platforming.html"><strong aria-hidden="true">1.5.3.</strong> Platforming</a></li><li class="chapter-item expanded "><a href="game-design/game-mechanics/creatures-ecosystem.html"><strong aria-hidden="true">1.5.4.</strong> Creatures / Ecosystem</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="policy.html"><strong aria-hidden="true">2.</strong> Development Policies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="policy/assets.html"><strong aria-hidden="true">2.1.</strong> Assets Organization</a></li><li class="chapter-item expanded "><a href="policy/cli.html"><strong aria-hidden="true">2.2.</strong> CLI Commands</a></li></ol></li><li class="chapter-item expanded "><a href="tech.html"><strong aria-hidden="true">3.</strong> Technical Documentation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tech/cli.html"><strong aria-hidden="true">3.1.</strong> Dev Console</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tech/cli-ref.html"><strong aria-hidden="true">3.1.1.</strong> Cli Commands Reference</a></li><li class="chapter-item expanded "><a href="tech/cli-howto.html"><strong aria-hidden="true">3.1.2.</strong> How to create new CLI Commands</a></li></ol></li><li class="chapter-item expanded "><a href="tech/script.html"><strong aria-hidden="true">3.2.</strong> Scripts How-To</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tech/script-ref.html"><strong aria-hidden="true">3.2.1.</strong> Script Format Reference</a></li></ol></li><li class="chapter-item expanded "><a href="tech/anim.html"><strong aria-hidden="true">3.3.</strong> Animations How-To</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tech/anim-ref.html"><strong aria-hidden="true">3.3.1.</strong> Animation Format Reference</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">TheSeeker Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="game-design"><a class="header" href="#game-design">Game Design</a></h1>
<p>This chapter is for things about the high-level design of the game.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="target-audience"><a class="header" href="#target-audience">Target Audience</a></h1>
<p>This game combines various features and mechanics of:</p>
<ul>
<li>metroidvanias (i.e Hollow Knight)</li>
<li>action RPGs (i.e Diablo)</li>
<li>Sandbox Adventure Games (i.e Red Dead Redemption)</li>
</ul>
<p>The fans of these genres are then naturally the audiences we're targetting.
This game is meant to give you the sense of mystery and non-linear exploration known from Metriodvanias,
combined with the deep character build customization and intense combat known from action RPGs,
while also allowing the player to (for the most part) define their own path and goals while inhabiting a mostly 'natural' and un-scripted world, like in Sandbox Adventures.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monetization"><a class="header" href="#monetization">Monetization</a></h1>
<p>The core ideas behind the Monetization strategy for this game are:</p>
<ul>
<li>minimizing middle-men (Kickstarter, Steam, Publishers, etc)</li>
<li>decoupling monetization from the design process (no profit oriented design decisions)</li>
<li>not monetizing the gameplay itself (FOSS), but instead monetizing 'prestige' and 'identity' (being able to show you supported something cool, and being a part of an exclusive club)</li>
<li>maximizing freedom from legal paperwork</li>
<li>maximizing creative flexibility (no strict deadlines, flexible work hours, ability for many people to contribute as much or as little as they want and be easily compensated)</li>
</ul>
<p>This game is not only meant to be an interesting project on the game-design front itself, but also an experiment with a completely new way of work/organization.</p>
<p>Based on these goals, we chose the following monetization strategy:</p>
<ul>
<li>The game will be developed as a fully open sourced project.</li>
<li>As we create new assets (art, music, or even code) we turn them into digital collectibles using the Ordinals protocol.</li>
<li>These assets have no impact on the game itself (the game is fully off-line) but instead function as a kind of 'digital autographs' from the creators, while also having artistic and collectible value.</li>
<li>By owning one of these collectibles you will be able to show that you supported this project at a very early stage, and if the popularity of this game grows, chances are the value of these collectibles will grow as well.</li>
<li>It can be seen as similar to an aspiring football player selling a limited quantity of balls with their autographs on them when they are just starting out their career, and if they become a famous player, those signature balls will have immense value.</li>
<li>In our case there's also a possibility of giving the owners of these collectibles special perks similar to the perks you see in Kickstarter campaigns. For example being able to design custom creatures/npcs for the game, being able to have private talks with the team, being mentioned in game credits or in game itself, getting access to early releases, etc. By owning one of our collectibles you become a part of an exclusive club with special perks.</li>
<li>The collectible items will be sold directly for Bitcoin, and contributors will be mostly paid directly in Bitcoin. There's also an option to be paid in the collectibles themselves, which is a bit similar to being paid in company stocks (you can profit more directly from the success of the project instead of just from your work hours alone)</li>
<li>The beauty of this design is that all profits from collectible sales go directly to us, without some corporation in the middle taking a big cut. With typical crowdfunded games you have to deal with both the crowdfunding platform cut (Kickstarter), and then once you release the game the marketplace cut (Steam) which ends up being a very significant amount of your fanbase's money going to completely unrelated entities..</li>
<li>It will also make the game much more accessible - since we're not monetizing the game itself, anyone will be able to play it regardless of their financial situation.</li>
<li>This approach also gives us a lot of flexibility - there's no deadline we need to hit in order to get some singular big sale event. We release collectibles as we go, and we adjust our scope based on how much funding we get. People can also freely join and leave the project and be paid per contribution.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="art-direction"><a class="header" href="#art-direction">Art Direction</a></h1>
<ul>
<li>Low-res pixel art (6x6 tile size, 12px player height)</li>
<li>Low saturation</li>
<li>No outlines</li>
<li>Focus on good readability and color harmony</li>
<li>Player should ideally be the only yellow'y asset in game to make it very visible</li>
<li>All assets drawn fully lit and then darkness added as a post processing shader</li>
<li>Multi-layered and parallaxed background and foregrounds</li>
<li>Focus on auto-tiling, to save time designing levels</li>
<li>Backgrounds and foreground mostly simple silhouettes so attention is on the main platforms</li>
<li>Procedural fogs and blur layers to build atmosphere and make backgrounds grab even less attention</li>
<li>Atmospheric lighting and bloom™️</li>
<li>I would love to have lighting with normal maps at some point but it might be too much work</li>
<li>All animations play at 12fps</li>
<li>Shaders for environment so it reacts to player (like vegetation moves when you run through it, or water splashes etc)</li>
<li>Procedural 'dust' trail behind player when jumping (like in hollow knight)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-lore"><a class="header" href="#game-lore">Game Lore</a></h1>
<p>The idea behind the game is to be a kind of 'trojan horse', in the sense that is has 2 different levels of
meaning, where one is the more surface level one that is meant to be just fun, attention grabbing and
aesthetically pleasing and it serves as the vehicle to convey the deeper meaning that won't be told in
any explicit way but more something that has to be discovered.
That being said the deeper meaning will still be 'experienced' even if the player doesn't discover it.
More on that in a bit.</p>
<p>The surface level of meaning is that it's a sci-fi world where humanity discovers a new planet with life
on it, but the planet is almost entirely covered by a thick ice/snow layer similar to Hoth from Star Wars.
The planet's inhabitants all live in deep cave systems below the surface, heated by geothermal energy.
The deeper the caves the warmer it gets, creating a deep network of biomes and ecosystems.</p>
<p>The player is one of the first settlers on the planet, and the game is meant to be something like a Red
Dead Redemption in space. Where the player has a lot of freedom to just explore the beautiful
underground alien landscapes and seek their own meaning and goals within that world, while
occasionally returning to the surface to trade and share knowledge with the other settlers.
The main goal behind this surface layer of meaning is to create a feeling of 'awe' and curiosity and put
the player in an engaged and attentive state.</p>
<p>The deeper level of meaning can be split into 2 categories. The first is still told in an explicit way, in the
form of a plot twist at the end of the game:
It turns out the entire planet is something similar to a massive hivemind embryo, which uses one of the
core properties of advanced civilizations - curiosity - as a way to lure them further down towards the
planet's center.
The various creatures the player fights on the way down are a sort of selection mechanism, a kind of
challenge where only a new unique strategy can solve it and reach the bottom.
Once the player reaches the bottom, the planet 'consumes' it and all the data the player generated on
their way down. The planet then recallibrates to account for the new data, and the game starts over with
a new settler arriving on the planet. But now the planet is evolved and the challenges it presents are
more complex.
This could sound like a kind of 'space horror' ending, but that's actually not the intention. This leads to
the final layer of meaning, the one that is not told explicitly but only told through the design of the
game itself.</p>
<p>The final level of meaning is inspired by various scientific and mathematical theories, the most notable
ones by Donald Hoffman and Stephen Wolfram.
The concept I want to explore in the deepest level of this game is the idea that mathematics could be
the foundational layer of reality, consciousness and even emotional states.
For example, you can define a triangle as '3 points connected together' but you can also define a
triangle as 'an experience'.
Similar with colors, frequencies, etc. With those it's actually more obvious to us. We know that red
feels different to green, and also that different musical frequencies create different experiences.
And then from those ‘atomic’ building blocks you can form any complex emotional state.
And the idea is to invite the player to <em>experience</em> mathematics, instead of just understanding it.
Experience how prime numbers feel, compared to even numbers, experience the fibonacci sequence
and how different it feels from say the mandelbrot set.
So how we achieve this in game, is by precisely tuning various parameters, to create mathematical
relationships between them.</p>
<ul>
<li>We pick a 'fundamental frequency' that will tie everything together. In this case this ‘fundamental’ is 12.</li>
<li>All animations will play at 12fps (12hz).</li>
<li>All music will have a fundamental frequency of 48hz (exact 2 octaves above animations).</li>
<li>All rhythm will be 90bpm (again the same 'fundamental' just a few octaves lower).</li>
<li>Size of tiles will be 6x6 pixels (1/2 of 12).</li>
<li>Player height is exactly 12p pixels.</li>
<li>And many many more things like these.</li>
</ul>
<p>This is meant to create a highly 'resonant' and meditative experience, where the entire experience is
tightly synchronized.
It won't be made obvious to the player, at best it will just 'feel good'.
And then once we establish the fundamental, we can start exploring different mathematical concepts
with it.
Create musical patterns between various mathematical sequences and see how they feel.
Create certain levels in game let's say using only prime number multiples of the base tiles as platform
lengths. Since animation frequency will be tied to rhythm and pitch, various lengths of animations will
create different kinds of time divisions/polyrhythms, generating even more complex structures.
And all of those mediums will create different kinds of synergies together.
Say hearing prime number based music sequence while exploring a fibonacci based level, etc etc.
Again, the goal is not to make this obvious, and make it something that the player experiences
subconsciously, while being focused and entertained by the surface level of meaning.
And then the idea behind the game ending, with the planet recallibrating, together with the
mathematical meaning, is meant to touch on the topic of the ruliad / 'godel's infinite candy store'.
The idea that as we find new potential mathematic/conscious states it opens up the doors to even newer
ones, in an infinite loop of conscious expansion.
Every iteration of the game open up brand new conscious experiences based on the previous
playthrough.
And it's important to mention the player is also an 'instrument' here.
Due to the animation sync all their actions produce sfx sounds that will be synced to some division of
the base fundamental frequency.
So what the player does in each iteration, influence by the new callibration of the planet, is a key part
of the whole experience, and those actions by the player influence the future configuration, etc, creating
a feedback loop that keeps generates new mathematical/conscious structures.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gameplay--mechanics"><a class="header" href="#gameplay--mechanics">Gameplay / Mechanics</a></h1>
<p>The overall idea is to have a game that combines open sandboxy exploration with intense combat and itemization mechanics</p>
<p><strong>EXPLORATION</strong></p>
<p>On the exploration front this can be seen as a combination of the overall feel of a sandbox game (Red Dead Redemption style, but in a 2D setting) with some Metroidvania mechanics (similar to Hollow Knight)
The metroidvania mechanics here are mostly the platformer style gameplay with the typical 'teasing of certain locked areas' where the player needs to get some item or ability to access those areas.
The locked areas don't have as much of a gamplay significance as in Metroidvanias, instead they are used more as just a way to motivate the player to explore.
This motivation will be the core driver of progress in this game, as there won't be any explicit 'quest' given to the player. (There will be side-quests but no overarching grand mission)
Instead the player explores the deep alien cave systems mostly out of curiosity and the will to experience more of the hidden beauty of the planet.
Therefore various mechanics need to really prioritize feeding this curiosity to make this design work.</p>
<p><strong>COMBAT AND ITEMIZATION</strong></p>
<p>Combat and itemization take a lot of inspiration from games like Diablo and Risk of Rain.
On the build/combat side that means prioritizing synergy - giving player a wide range of skills and items that can all interact with each other in interesting ways, while trying to minimize incompatible combinations. This also ties back into the idea of curiosity: the player is not only driven by trying to explore the world, but also by trying to explore the various <em>ways of exploring</em> this world, in the form of countless different playstyles.
This is also tied into itemization, where item drops are specific to certain creatures/species and so that in turn motivates the player to explore various areas of the map to kill those creatures to be able to obtain their items which in turn can be used in crafting to enable new build combinations. 🔄
At the same time the various creatures have different strengths and weaknesses, so the player might need to swap builds in preparation for fighting in different areas.
For instance creatures in cold areas might be more vulnerable to fire builds, while creatures in magma biomes might be more vulnerable to cold builds.
Item drops will also be creature-dependent. This creates a potential gameplay scenario where for instance you might need to go kill some fiery creatures to get fire items, and then those items will allow you to explore some icy area better and vice-versa. Again incentivizing exploration and curiosity.
So overall there's a nice feedback loop  within this design where all the parts synergize to incentivise exploration and curiosity, both in the area of mechanics and in the area of actual world exploration.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="active-skills"><a class="header" href="#active-skills">Active Skills</a></h1>
<p>Active skills are skills that need to be manually triggered by the player and have an active visual effect and usually come with their own animations.
For example, a basic sword slash, or a spinning melee attack, or shooting guns, or a dash
All active skills can either be used independently of the weapon the player uses (like a dash, or putting a turret on the ground)
Or they are dependent only on the category of the weapon: melee or ranged, and since the player always has 1 melee and 1 ranged weapon equipped, using those skills will automatically use the correct weapon.</p>
<p>So for instance, if you have a 'spinning melee attack' equipped and you have a hammer in your melee weapon slot, you will start spinning with a hammer.
But if you use this attack while having a sword in your melee weapon slot you will start spinning with a sword.</p>
<p>This means there's no need to ever manually swap your weapons, and all skills you equip will always be available to you
There will be around 30 active skills, and you will be able to equip 4-5 of them at a time (I'll have to see what number feels the best in game)
in terms of acquiring the skills, I will initially make it so that every time you kill an enemy you have a small chance that a random skill will be unlocked. Later I might come up with some better way of progression, but this should work for now</p>
<p>Also, one important design goal is to minimize the interdependence between movement and attacks: for example you can perform all basic attacks in all states, when running, jumping and falling, and the attacks won't slow you down or impact your motion
the only instance where active skills will impact your motion is when those skills are movement related skills, like a dash
the overall goal here is to make the combat as seamless as possible, no need to think about swapping weapons or whether you're currently jumping or running, when you hit that attack button you will always get the desired effect
I'm also considering implementing a very basic auto-aim for ranged weapons, so if there are no enemies in the direction where you are running you will shoot backwards
but if there are enemies in both directions then you shoot in direction of motion.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="passive-skills"><a class="header" href="#passive-skills">Passive Skills</a></h1>
<p>Passive skills are skills that are always active and have a passive effect on you, and that mostly means modifying certain stats based on specific conditions
For example: 'deal double damage when you're at very low health', or 'deal more damage when attacking from behind', or 'deal more damage when there are no enemies in close proximity to you', or 'critical hits reduce your active skills cooldowns', etc
Each one of those passive skills is meant to incentivize a specific kind of playstyle
For example, the passive that makes you deal more damage when no enemies are nearby incentivizes ranged builds that involve staying away from enemies, so ranged attacks that stun or push back or slow down your enemies will work well with this.
Since those passives are mostly just modifying variables based on If statements, it should be very easy to implement a lot of those
I'm thinking having between 30 and 50 should be relatively easy for a start
The player will be able to have around 5 of those passives equipped at a time
The power of this approach is that if we assume 50 passives where you can pick 5 at a time, that's already 2,118,760 possible combinations, just with those passives, without even including the active skills or the weapon choices.
An important design goal here is to make those passives as compatible with eachother as possible.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="platforming"><a class="header" href="#platforming">Platforming</a></h1>
<p>Platforming is very similar to hollow knight:</p>
<ul>
<li>variable jump height</li>
<li>double jump</li>
<li>wall slide/kick</li>
<li>coyote time</li>
<li>fall part of the jump slightly faster than the jump part, to make it less floaty</li>
</ul>
<p>I would like platforming puzzles to be an important, though mostly optional part of the game, where players can access hidden areas and get interesting items by completing difficult platforming challenges
but being good at platforming will not be needed to enjoy the game</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creatures--ecosystem"><a class="header" href="#creatures--ecosystem">Creatures / Ecosystem</a></h1>
<p>creatures are divided into those 3 overall categories:</p>
<ol>
<li>Herbivores</li>
<li>Carnivores</li>
<li>Scavengers</li>
</ol>
<p><strong>Herbivores</strong> are mostly limited to specific 'oasis' areas in the caves where heat and water from geysers causes vegetation to grow which they can eat.
One problem for them is that they are obvious targets in those areas, so they usually go there only briefly to eat and then hide in other areas of the cave.
They attack the player only defensively and try to run away.
Unless they have cubs, then they will attack actively.</p>
<p><strong>Carnivores</strong> patrol large areas looking for Herbivores, but most often they sit near the oasis areas waiting for Herbivores to appear.
They will actively attack the player whenever they get near. Their 'sight' is larger than screen size so they can spot the player from farther away and start to chase them.
Their cubs behave the same way, and accompany parents during hunts</p>
<p><strong>Scavengers</strong> patrol large areas looking for leftover meat. They attack the player only defensively and try to run away if isolated. But they will attack actively and chase the player when in larger groups.
The will always attack actively when they have cubs, and the cubs will also join them in attacking.</p>
<p>So for any level the minimum viable ecosystem requires 6 creatures.</p>
<ol>
<li>Herbivore + cub</li>
<li>Carnivore + cub</li>
<li>Scavenger + cub</li>
</ol>
<p>There might also be additional creatures beyond this basic ecosystem, like 'bats' that attack everything that gets near, or 'trap creatures' that just sit idle until something gets near and then strike</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development-policies"><a class="header" href="#development-policies">Development Policies</a></h1>
<p>This chapter is to describe processes and policies that everyone on the game's
dev team should follow.</p>
<p>Whenever we come up with conventions for how to do things, we should document
them here, so everyone is up to speed.</p>
<h2 id="areas-of-responsibility-for-the-github-repository"><a class="header" href="#areas-of-responsibility-for-the-github-repository">Areas of Responsibility for the GitHub repository</a></h2>
<p>Documentation: everyone! Feel free to contribute to docs at any time.</p>
<p>Assets: @c12. They are responsible for making sure all the assets committed into
the repo are valid, in the correct formats, follow our practices, etc. They should
work together with artists to put their work into the repo and ensure that.</p>
<p>Code:</p>
<ul>
<li>@odecay:
<ul>
<li>Player gameplay mechanics: movement, physics, attacks, abilities, etc.</li>
<li>Enemy gameplay mechanics: AI, movement, physics, attacks, abilities, etc.</li>
</ul>
</li>
<li>@destravous:
<ul>
<li>Shaders and graphics</li>
</ul>
</li>
<li>@inodentry (Ida):
<ul>
<li>Everything else unless specified otherwise.</li>
</ul>
</li>
</ul>
<h2 id="pull-requests-and-collaboration-for-programmers"><a class="header" href="#pull-requests-and-collaboration-for-programmers">Pull Requests and Collaboration for Programmers</a></h2>
<p>We are a small team of a few developers, and as such it is manageable to have
very loose policies to keep development momentum going. :)</p>
<p>We use GitHub Pull Requests as an aid in development, but not a strict requirement.</p>
<p>For contributors that do not have push/merge permissions on GitHub, the PR process
is mandatory. Whenever you work on something, just make a PR so we can review and
merge it for you. :)</p>
<p>For members who have push/merge permissions on GitHub, feel free to skip the PR process
and push directly to the <code>main</code> branch <strong>if</strong>:</p>
<ul>
<li>You are working on documentation.</li>
<li>You have made a small change that doesn't significantly change the codebase and
does not intefere with anything others are working on (to your knowledge).</li>
<li>You have made an urgent or important fix, or you know others on the team need
something (uncontroversial) urgently.</li>
<li>You are working on something very self-contained that is in a part of the codebase
that only you are working on / responsible for.</li>
</ul>
<p>For all other situations, you should create PRs.</p>
<p>Please use the GitHub PR Draft status to indicate if you consider your work ready for
merging. Feel free to think of Draft PRs as a "safe space" for you to work on stuff
without interfering with development on the main branch. Creating PRs for your work,
even if it is an early unfinished WIP, is good for transparency. It allows others
to see what you have been up to and give feedback.</p>
<p>When you change your Draft PR to a normal PR, you signal that you want your work merged.</p>
<p>Feel free to ask other developers on the team for code reviews at any time.</p>
<p>For merging PRs, anyone on the dev team with GitHub merge/push permissions can merge
PRs from other people, <strong>if</strong>:</p>
<ul>
<li>The PR is not a Draft PR.</li>
<li>The PR is not known to interfere with any other current work outside of the author's
area of responsibility.</li>
</ul>
<p>You may only merge your own PR <strong>if</strong>:</p>
<ul>
<li>All of the above.</li>
<li>You are reasonably sure that nobody on the team would object to it.</li>
<li>You have informed other team members that you are going to do it.</li>
</ul>
<p>Reviews are optional, but we encourage everyone to solicit reviews from other team
members.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assets-organization"><a class="header" href="#assets-organization">Assets Organization</a></h1>
<p>This page describes our practices for the game's asset files.</p>
<h2 id="source-files"><a class="header" href="#source-files">Source Files</a></h2>
<p>If there are any "source" files (project files from the artist's workflow, when
the artist works in formats other than what the game ingests), they can be kept
in the <code>assets-src</code> folder, and must be added via <a href="https://docs.github.com/en/repositories/working-with-files/managing-large-files/configuring-git-large-file-storage">Git
LFS</a>.</p>
<p>This is optional and up to <code>c12</code> and artists. They should decide what files we
want to officially store with the GH repo.</p>
<h2 id="general-organization"><a class="header" href="#general-organization">General Organization</a></h2>
<p>The <code>assets</code> folder contains the files as they should be ingested by Bevy. This
is what the game loads and uses.</p>
<p>All the assets to be loaded by the game must be listed/declared in the <code>*.assets.ron</code>
<a href="https://github.com/NiklasEi/bevy_asset_loader#dynamic-assets">dynamic asset</a> files.</p>
<p>Please look at those files. Each one has comments describing how it is supposed to be
used.</p>
<p>Currently, the game pre-loads all assets during the startup loading screen. In
the future, assets specific to a given level/area will be loaded dynamically
during gameplay.</p>
<h2 id="audio"><a class="header" href="#audio">Audio</a></h2>
<p>All audio assets must be in FLAC format. Should be encoded for maximum compression, like:</p>
<pre><code class="language-sh">flac --best &lt;file.wav&gt;
</code></pre>
<h2 id="images"><a class="header" href="#images">Images</a></h2>
<h3 id="most-art-assets"><a class="header" href="#most-art-assets">(most) Art Assets</a></h3>
<p>Images should be stored as PNG and aggressively optimized for size. If you are going to
add new files to the repo, please install <code>optipng</code> and <code>zopflipng</code> on your system,
and run the following commands to process the files:</p>
<pre><code class="language-sh">optipng -i 0 -strip all -zc1-9 -zm1-9 -zs0-3 -f0-5 &lt;file.png&gt;
zopflipng -y -m --lossy_transparent --filters=01234mep &lt;file.png&gt; &lt;file.png&gt;
</code></pre>
<p>If you have <code>fd</code>, you can easily run these commands on all PNG files, using all your
CPU cores for processing:</p>
<pre><code class="language-sh">cd folder;
fd -e png -x optipng -i 0 -strip all -zc1-9 -zm1-9 -zs0-3 -f0-5 {} \; -x zopflipng -y -m --lossy_transparent {} {}
</code></pre>
<h3 id="special-gpu-textures"><a class="header" href="#special-gpu-textures">Special GPU textures</a></h3>
<p>If we need specific GPU Texture features that cannot be used via PNG, then KTX2+zstd
is the format that should be used. Compress at level 19:</p>
<pre><code class="language-sh">toktx &lt;other_options&gt; --zcmp 19 &lt;file.ktx2&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cli-commands"><a class="header" href="#cli-commands">CLI Commands</a></h1>
<p>These are our policies for CLI Commands (for the <a href="policy/../tech/cli.html">Dev Console</a>, etc.).</p>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<p>When committing new CLI Commands into the GitHub Repo, please make sure to add
an entry for them on <a href="policy/../tech/cli-ref.html">this page</a>, so other people in our
team can know about it.</p>
<h2 id="naming"><a class="header" href="#naming">Naming</a></h2>
<p>A command's name should be unambiguous/understandable but brief and easy to type. This
is subjective, but try to strike a balance: avoid overly terse abbreviations or overly
long and verbose names.</p>
<p>If you notice that we have existing commands that do something similar to your new
command, try to create/follow a consistent naming pattern to keep things intuitive.</p>
<p>Examples:</p>
<p>Good name: <code>locale</code>. Bad name: <code>chloc</code>. Bad Name: <code>change_ui_locale</code>.</p>
<p>Good name: <code>level</code>. Bad name: <code>chlvl</code>. Bad name: <code>switch_to_level</code>.</p>
<p>Good name: <code>spawn_anim</code>. Bad name: <code>spa</code>. Bad name: <code>spawn_animation_test_entity</code>.</p>
<p>Good name: <code>spawn_enemy</code>. Bad name: <code>place_enemy</code>. (we have other <code>spawn_*</code> commands,
you should follow the naming pattern)</p>
<h2 id="arguments"><a class="header" href="#arguments">Arguments</a></h2>
<p>Try to follow a general pattern of least-specific to most-specific where it makes sense.</p>
<p>If there are other commands that do something similar, try to be consistent with them.</p>
<p>Good example:</p>
<pre><code>spawn_enemy &lt;kind&gt; &lt;hp&gt; &lt;x&gt; &lt;y&gt;
</code></pre>
<pre><code>spawn_enemy MonsterKind01 50 100 200
</code></pre>
<p>The kind of enemy is the less-specific piece of info, so it comes first. The X/Y coordinates
where to put it are the more-specific / dynamic piece of info, so they come last.</p>
<p>Bad example:</p>
<pre><code>spawn_effect 50 70 SmokeEffect
</code></pre>
<p>This order of arguments is the opposite of what is recommended. Also, it is inconsistent
with the pattern followed by other similar commands, such as <code>spawn_anim</code>.</p>
<h2 id="implementation"><a class="header" href="#implementation">Implementation</a></h2>
<p>The Rust function that implements a command, should be named as the command name with a <code>cli_</code> prefix.</p>
<p>Good example:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn cli_exit(/* ... */) {
    // ...
}

app.register_clicommand_noargs("exit", cli_exit);
<span class="boring">}</span></code></pre></pre>
<p>Bad example:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn change_locale(/* ... */) {
    // ...
}

app.register_clicommand_args("locale", change_locale);
<span class="boring">}</span></code></pre></pre>
<h2 id="where-in-the-source-code-to-put-it"><a class="header" href="#where-in-the-source-code-to-put-it">Where in the source code to put it?</a></h2>
<p>The general place for miscellaneous CLI commands is <code>game/src/cli.rs</code>.
If you don't know where to put something, put it there. When in doubt, put it there.</p>
<p>If a command is specific to some aspect of the game or needs access to private
implementation details, it is acceptable to put it in the file where that
functionality is otherwise implemented. For example, it is okay to have
camera-related CLI commands in <code>game/src/camera.rs</code>.</p>
<p>DO NOT put any cli commands in the <code>engine/</code> source code tree (the library part of
the repo/project). All cli commands should be in <code>game/</code> (the executable/app).</p>
<h3 id="dev-only-commands"><a class="header" href="#dev-only-commands">Dev-only commands</a></h3>
<p>The <code>game/src/dev.rs</code> file is only compiled with the <code>dev</code> cargo feature. If
you are making a command that should only be available in the dev builds of the
game, put it there.</p>
<p>If you want to make a dev-only command, but have to put it elsewhere, in a file
that is compiled in regular builds of the game, you can add a conditional compilation
attribute:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[cfg(feature = "dev")]
fn cli_mydevcommand() {}
<span class="boring">}</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="technical-documentation"><a class="header" href="#technical-documentation">Technical Documentation</a></h1>
<p>This chapter of the book is for any general technical documentation relevant to
the game, that is not covered by the API docs.</p>
<p>Please use doc comments in the source code as much as possible instead, for anything
that should "live with the source code". It is much easier to keep docs updated, if
they are kept alongside the code.</p>
<p>However, there are things that might not be suitable to document in the source code,
such as overall architectural decisions, or anything that might also be useful to
non-programmers. That is what this chapter is for. :)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dev-console"><a class="header" href="#dev-console">Dev Console</a></h1>
<p>The Dev Console is a very handy and important thing to use during game
development. It is expected that everyone in the project is familiar with it.
It allows you to mess around with things in-game, which is very important for
testing out different functionality, incl. stuff that is not yet available via
the normal gameplay or UI.</p>
<h2 id="how-to-use"><a class="header" href="#how-to-use">How to use</a></h2>
<p>The most obvious way to use CLI commands is interactively via the on-screen
in-game console prompt.</p>
<p>To bring up the console, press the <code>`</code> or <code>~</code> key.</p>
<p>This will bring up an on-screen prompt, where you can type your command.</p>
<p>Command history (using up-arrow to bring up previous commands) is supported.</p>
<h2 id="available-commands"><a class="header" href="#available-commands">Available commands</a></h2>
<p>We document all commands <a href="tech/./cli-ref.html">on this page</a>.</p>
<p>If you want to know what commands are available in your build of the game,
you can use the <a href="tech/./cli-ref.html#help"><code>help</code></a> command to list them.</p>
<p><a href="tech/./cli-howto.html">See here for how to create your own commands.</a></p>
<h2 id="from-rust-code"><a class="header" href="#from-rust-code">From Rust code</a></h2>
<p>CLI commands are useful beyond just the dev console. They are effectively
named Bevy systems that you can run by name.</p>
<p>If you want to run a CLI command from Rust, you can do so.</p>
<p>Using <code>Commands</code> (yes, the regular bevy kind), from a Bevy system:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn my_system(
    mut commands: Commands,
) {
    // provide exactly the same string as you would in the devconsole prompt
    commands.run_clicommand("dothing arg 1.0 2.0 3.0");
    commands.run_clicommand("hello");
}
<span class="boring">}</span></code></pre></pre>
<p>This will queue up your CLI to run whenever Bevy <code>Commands</code> get applied next.</p>
<p>If you have direct <code>World</code> access (from a Bevy exclusive system):</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn my_system(
    world: &amp;mut World,
) {
    world.run_clicommand("dothing blah blah");
}
<span class="boring">}</span></code></pre></pre>
<p>This will run the CLI immediately.</p>
<h2 id="from-bevy-ui"><a class="header" href="#from-bevy-ui">From Bevy UI</a></h2>
<p>CLI commands can also be hooked up to Bevy UI. For example, our main menu
buttons are implemented to just call the respective CLI commands.</p>
<p>You can do so using the <code>OnClick</code> component (from <code>iyes_ui</code>):</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// create a button to run the `exit` command, to exit the app
commands.spawn((
    ButtonBundle {
        // ...
        ..default()
    },
    OnClick::new().cli("exit"),
));

// create a button to run multiple CLI commands: enter the game, and print hello to log
commands.spawn((
    ButtonBundle {
        // ...
        ..default()
    },
    OnClick::new().cli("AppState InGame").cli("hello"),
));
<span class="boring">}</span></code></pre></pre>
<h2 id="from-scripts"><a class="header" href="#from-scripts">From Scripts</a></h2>
<p>Commands can also be called from <a href="tech/./script.html">script</a> and
<a href="tech/./anim.html">animation</a> assets.</p>
<p>Yes, you can make an animation run arbitrary cli commands on
specific animation frames or whatever. ;)</p>
<p>This is very powerful and useful. If you need some custom functionality for your
scripts/animations, because you want to trigger it that way (very useful if you
want precise timings), just <a href="tech/./cli-howto.html">create a new cli command</a>!  Voila,
now you can trigger your custom behavior from scripts/animations!</p>
<pre><code class="language-toml"># On a specific tick
[[script]]
run_at_tick = 96
action = "RunCli"
cli = [
  "dothing blah blah",
  "domore etc etc",
]

# In animations, when a given frame index is displayed
[[script]]
run_at_frame = 7
action = "RunCli"
cli = [
  "hello",
]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cli-commands-reference"><a class="header" href="#cli-commands-reference">Cli Commands Reference</a></h1>
<p>This page lists the available <a href="tech/./cli.html">dev console</a> commands.</p>
<p>All of these commands can also be called from <a href="tech/./script.html">scripts</a>
using the <a href="tech/./script-ref.html#RunCli"><code>RunCli</code></a> script action.</p>
<h2 id="general-commands"><a class="header" href="#general-commands">General Commands</a></h2>
<p>These commands are available in all builds of the game.</p>
<details>
  <summary>
  <code>AppState</code>
  </summary>
<p>Args:</p>
<pre><code>AppState &lt;State&gt;
</code></pre>
<p>Example:</p>
<pre><code>AppState InGame
AppState MainMenu
</code></pre>
<p>Immediately triggers a global AppState transition.</p>
</details>
<details>
  <summary>
  <code>camera_at</code>
  </summary>
<p>Args:</p>
<pre><code>camera_at &lt;x&gt; &lt;y&gt;
</code></pre>
<p>Example:</p>
<pre><code>camera_at 200 300
</code></pre>
<p>Makes the camera jump to the given coordinates. Useful if you want to look at
a specific location on the map.</p>
</details>
<details>
  <summary>
  <code>camera_limits</code>
  </summary>
<p>Used to manage camera limits (the viewable area). During normal gameplay, the
camera control algorithm should make sure nothing outside of these coordinates
is displayed on the screen.</p>
<p>Noargs:</p>
<pre><code>camera_limits
</code></pre>
<p>Prints the current camera limits to log.</p>
<p>Args:</p>
<pre><code>camera_limits &lt;xmin&gt; &lt;ymin&gt; &lt;xmax&gt; &lt;ymax&gt;
</code></pre>
<p>Example:</p>
<pre><code>camera_limits 100 200 300 400
</code></pre>
<p>Sets the camera limits.</p>
</details>
<details>
  <summary>
  <code>exit</code>
  </summary>
<p>Noargs:</p>
<pre><code>exit
</code></pre>
<p>Quits the app.</p>
</details>
<details>
  <summary>
  <code>hello</code>
  </summary>
<p>Silly trivial command for testing and example purposes. May be useful as
a placeholder during development.</p>
<p>Noargs:</p>
<pre><code>hello
</code></pre>
<p>Prints "Hello!" to log.</p>
<p>Args:</p>
<pre><code>hello &lt;arg&gt;
</code></pre>
<p>Example:</p>
<pre><code>hello world
</code></pre>
<p>Prints "Hello, {arg}!" to log. For example: "Hello, world!"</p>
</details>
<details>
  <summary>
  <code>help</code>
  </summary>
<p>Noargs:</p>
<pre><code>help
</code></pre>
<p>Prints a list/summary of all available CliCommands to log.</p>
</details>
<details>
  <summary>
  <code>locale</code>
  </summary>
<p>Args:</p>
<pre><code>locale &lt;locale&gt;
</code></pre>
<p>Example:</p>
<pre><code>locale bg-BG
locale en-US
</code></pre>
<p>Instantly changes the game's locale (UI/text language) at runtime.</p>
<p>Useful for testing how things look in different locales.</p>
</details>
<h2 id="dev-only-commands-1"><a class="header" href="#dev-only-commands-1">Dev-only Commands</a></h2>
<p>These commands are only available if the game was compiled with the <code>dev</code>
feature.</p>
<p>For example, you can run the game as:</p>
<pre><code class="language-sh">cargo run --features dev
</code></pre>
<details>
  <summary>
  <code>spawn_anim</code>
  </summary>
<p>Args:</p>
<pre><code>spawn_anim &lt;asset_key&gt; [&lt;X&gt; &lt;Y&gt;]
</code></pre>
<p>Example:</p>
<pre><code>spawn_anim anim.player.Run
spawn_anim anim.player.RunWithDamage 50 60
</code></pre>
<p>Spawns an animation test entity to play/preview the given animation asset.</p>
<p>Useful when developing new animations, to test them, before they are integrated
into actual gameplay.</p>
<p>The X/Y coordinates are optional and default to 0,0.</p>
</details>
<details>
  <summary>
  <code>spawn_phystester</code>
  </summary>
<p>Args:</p>
<pre><code>spawn_phystester &lt;X&gt; &lt;Y&gt;
</code></pre>
<p>Example:</p>
<pre><code>spawn_phystester 200 300
</code></pre>
<p>Spawns a physics test entity. The entity is displayed as a pink square, but with
a circular collider. It has a full Dynamic rigid body, so it will fall with
gravity and bounce off walls and other colliders.</p>
</details>
<details>
  <summary>
  <code>spawn_script</code>
  </summary>
<p>Args:</p>
<pre><code>spawn_script &lt;asset_key&gt;
</code></pre>
<p>Example:</p>
<pre><code>spawn_script script.cutscene.intro
</code></pre>
<p>Spawns an entity to run the given script.</p>
<p>This can be useful for testing scripts.</p>
</details>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-create-new-cli-commands"><a class="header" href="#how-to-create-new-cli-commands">How to create new CLI Commands</a></h1>
<p>(<a href="tech/../policy/cli.html">see here</a> for our policies/conventions on how to do things)</p>
<hr />
<p>If you want to add/implement a new command into the game, here is how.</p>
<p>Every command is implemented as a Bevy system, in the Rust code of the game.
Both regular and exclusive systems are supported. You can use any standard Bevy
system params, to access whatever data you want.</p>
<p>You <strong>must</strong> register your cli commands using the Bevy app builder.</p>
<p>There are two kinds of commands: <em>noargs</em> and <em>args</em>.</p>
<h2 id="noargs-commands"><a class="header" href="#noargs-commands">Noargs commands</a></h2>
<p><em>Noargs</em> commands are bare Bevy systems:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn cli_mything(
    mut commands: Commands,
    my_query: Query&lt;&amp;Thing&gt;,
    my_res: Res&lt;&amp;MyThing&gt;,
    // ...
) {
    // ... do something ...
}
<span class="boring">}</span></code></pre></pre>
<p>We can register it as follows:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>app.register_clicommand_noargs("mything", cli_mything);
<span class="boring">}</span></code></pre></pre>
<p>You provide the name string that users will have to type in the console to
invoke the command, and the function (bevy system) that implements the command.
They don't have to match.</p>
<p>You can then call it from the Dev Console as such:</p>
<pre><code>mything
</code></pre>
<h2 id="args-commands"><a class="header" href="#args-commands">Args commands</a></h2>
<p><em>Args</em> commands must start with a special <code>In</code> parameter, which is how they
get the values of the arguments provided via the dev console / script:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn cli_mything(
    In(args): In&lt;Vec&lt;String&gt;&gt;,
    // bevy system params follow:
    my_query: Query&lt;&amp;Thing&gt;,
    // ...
) {
    // we can now process/parse the args:
    if args.len() != 1 {
        error!("Expected exactly 1 argument!");
        return;
    }
    let Ok(value) = args[0].parse::&lt;f32&gt;() {
        error!("Expected a numeric value as an argument!");
        return;
    }

    // ... do something with `value` and `my_query` or whatever
}
<span class="boring">}</span></code></pre></pre>
<p>(note: the engine only splits the CLI string on spaces and does not do any extra
processing for you. Your function must take <code>In&lt;Vec&lt;String&gt;&gt;</code>.)</p>
<p>(also note: the name of the command itself is not included in that <code>Vec</code>.
<code>args[0]</code> contains the first CLI argument, after the space separator)</p>
<p>We can register it as follows:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>app.register_clicommand_args("mything", cli_mything);
<span class="boring">}</span></code></pre></pre>
<p>You provide the name string that users will have to type in the console to
invoke the command, and the function (bevy system) that implements the command.
They don't have to match.</p>
<p>You can then call it from the Dev Console as such:</p>
<pre><code>mything 1.0
</code></pre>
<h2 id="how-the-cli-runtime-works"><a class="header" href="#how-the-cli-runtime-works">How the CLI Runtime works</a></h2>
<p>Depending on what you typed in the dev console / script (the CLI string), the
engine will look for the respective kind of command by name.</p>
<p>When you try to run a command by name only (there are no spaces in the CLI
string), the engine will look for a <em>noargs</em> command by that name.</p>
<p>If the CLI string contains spaces, it will be split on those spaces, and
the engine will look for an <em>args</em> command whose name matches the first
part of the CLI string. The remaining substrings will be passed as arguments.</p>
<p>It is possible to register both a <strong>noargs</strong> and and <strong>args</strong> command with
the same name. The correct one will be selected, depending on the presence
of spaces in the CLI string.</p>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<p>Say we register the following commands:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>app.register_clicommand_args("dothing", cli_dothing);
app.register_clicommand_args("hello", cli_hello_args);
app.register_clicommand_noargs("hello", cli_hello_noargs);
app.register_clicommand_noargs("exit", cli_exit);
<span class="boring">}</span></code></pre></pre>
<p>Here is what will happen if you type different things in the dev console:</p>
<hr />
<pre><code>exit
</code></pre>
<p>Will run the <code>cli_exit</code> Bevy system.</p>
<hr />
<pre><code>exit blah
</code></pre>
<p>Error: command not found.</p>
<p>(because no <em>args</em> command with the name <code>exit</code> exists)</p>
<hr />
<pre><code>hello
</code></pre>
<p>Will run the <code>cli_hello_noargs</code> Bevy system.</p>
<hr />
<pre><code>hello world
</code></pre>
<p>Will run the <code>cli_hello_args</code> Bevy system and pass in <code>vec!["world"]</code> as
the <code>In</code> parameter.</p>
<hr />
<pre><code>dothing
</code></pre>
<p>Error: command not found.</p>
<p>(because no <em>noargs</em> command with the name <code>dothing</code> exists,
it doesn't matter that an <em>args</em> command with that name exists)</p>
<hr />
<pre><code>dothing 10.5
</code></pre>
<p>Will run the <code>cli_dothing</code> Bevy system and pass in <code>vec!["10.5"]</code> as
the <code>In</code> parameter. Note that the argument is always passed in as
a string. The Rust function must do any processing it wants, such
as parsing it into a <code>f32</code> number, if that is what it expects.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripts-how-to"><a class="header" href="#scripts-how-to">Scripts How-To</a></h1>
<p>Script Assets are a way to drive/trigger things to happen in the game, without
using Rust code, at precise times.</p>
<p>Think of it like a sequencer. Useful if you want specific things to happen at
specific points in time, or repeat in specific intervals.</p>
<p>This should make it easy for us to author interesting in-game scenarios, such as
cutscenes, or general things to happen in the background in specific
rooms/areas/levels, etc.</p>
<h2 id="creating-new-script-files"><a class="header" href="#creating-new-script-files">Creating new script files</a></h2>
<p>Script files end in <code>.script.toml</code> and are loaded as Bevy assets, so they need
to be part of the <code>assets</code> folder. Make sure to create an entry in
<code>gameplay.assets.ron</code>, to ensure your scripts get loaded.</p>
<p><a href="tech/./script-ref.html">See here for the syntax / what you can put in the file.</a></p>
<h2 id="how-to-run-your-scripts"><a class="header" href="#how-to-run-your-scripts">How to run your scripts</a></h2>
<h3 id="cli"><a class="header" href="#cli">CLI</a></h3>
<p>You can use the <a href="tech/./cli-ref.html#spawn_script"><code>spawn_script</code></a> CLI command (for
example, from the <a href="tech/./cli.html">dev console</a>, for testing), to spawn a script into
the game.</p>
<pre><code>spawn_script script_asset_key
</code></pre>
<h3 id="rust"><a class="header" href="#rust">Rust</a></h3>
<p>From Rust code, you can run a script by spawning a special entity, as follows:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>commands.spawn(ScriptBundle {
    key: "script.asset.key",
});
<span class="boring">}</span></code></pre></pre>
<h3 id="scripts"><a class="header" href="#scripts">Scripts</a></h3>
<p>From another script:</p>
<pre><code class="language-toml">[[script]]
run_at_tick = 100 # or whatever
action = "SpawnScript"
asset_key = "script.asset.key"
</code></pre>
<h2 id="extended-scripts"><a class="header" href="#extended-scripts">Extended Scripts</a></h2>
<p>We have other asset types (such as <a href="tech/./anim.html">animations</a>) that are based on
Scripts, but extend them with additional features to tailor to specific use
cases.</p>
<p>These other asset types support everything that regular scripts can do, and
more.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="script-format-reference"><a class="header" href="#script-format-reference">Script Format Reference</a></h1>
<p>This page describes the syntax / file format for <a href="tech/./script.html">Script Assets</a>.</p>
<h2 id="settings"><a class="header" href="#settings">Settings</a></h2>
<p>A script file can have an optional <code>[settings]</code> section, where you can put
parameters that govern how the script is to be run by the game.</p>
<p>Everything here is optional.</p>
<p>Example:</p>
<pre><code class="language-toml">[settings]
time_base = "Relative"
tick_quant = "8+4"
</code></pre>
<p>The following properties are available:</p>
<details>
  <summary>
  <code>time_base</code>
  </summary>
<p>Configures the "time zero" point. From when does the script begin counting time?</p>
<ul>
<li><code>Relative</code>: from the moment it is spawned (default)</li>
<li><code>Level</code>: from the moment the current level was loaded</li>
<li><code>Startup</code>: from app startup</li>
</ul>
<p>This allows you to use scripts for "global" behavior, which should be tied to
the level or the entire app runtime. Could be useful for background events.</p>
<p>The script will "catch up" on any missed time after it is spawned. For example,
if you spawn a script with <code>time_base = "Level"</code> long after the level has been
loaded, any non-periodic actions in the script that should have happened in the
time before the script was spawned will be performed at the first tick when the
script runs.</p>
</details>
<details>
  <summary>
  <code>tick_quant</code>
  </summary>
<p>Ensure the script time is quantized to a specific number of ticks. This is
useful when specific scripts must run aligned to specific time intervals.</p>
<p>For example, <code>"8+4"</code> means that the script is only allowed to start on a tick
number that is a multiple of 8, offset/delayed by 4 ticks.</p>
</details>
<h2 id="actions"><a class="header" href="#actions">Actions</a></h2>
<p>A script file can contain any number of <em>actions</em> to be performed. This is the
meat of the script.</p>
<p>Every action is declared using a <code>[[script]]</code> section. Each such section
specifies one "action" with its associated parameters. You can have any number
of them in a script file.</p>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_at_tick = 0
action = "RunCli"
cli = [ "dothing blah blah" ]
</code></pre>
<p>Every <code>[[script]]</code> section <em>must</em> contain:</p>
<ul>
<li>a <em>trigger condition</em> to determine <em>when</em> to perform the action</li>
<li>an <code>action</code> field to specify the kind of action to perform</li>
<li>any additional parameters as required by the action, depending on the action kind</li>
</ul>
<h2 id="slots"><a class="header" href="#slots">Slots</a></h2>
<p>Slots are like global flags / boolean variables that can be used to control
a script at runtime. A slot has a name, which can be any string. The
value can be changed to <code>true</code> or <code>false</code> from Rust code. You can have script
actions that are only to be perfomed if specific slots are enabled/disabled.</p>
<p>In Rust:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>my_script_runtime.set_slot("MySlot", true);
<span class="boring">}</span></code></pre></pre>
<p>In the script file:</p>
<pre><code class="language-toml"># do something as soon as "MySlot" becomes true
[[script]]
run_on_slot_enable = "MySlot"
action = "..."

# do something every 8 ticks,
# if "MySlot" and "MySlot2" are both true,
# and neither of "MyOtherSlot" or "SlotSlot" are true.
[[script]]
run_every_n_ticks = "8"
require_slots_all = ["MySlot", "MySlot2"]
forbid_slots_any = ["MyOtherSlot", "SlotSlot"]
action = "..."
</code></pre>
<p>You can also change the value of slots from within scripts, using the
<code>SlotEnable</code>/<code>SlotDisable</code>/<code>SlotToggle</code> actions.</p>
<h2 id="available-trigger-conditions"><a class="header" href="#available-trigger-conditions">Available Trigger Conditions</a></h2>
<p>The trigger condition is a mandatory part of every <code>[[script]]</code> section. It
determines when to run the action.</p>
<p>Multiple trigger conditions are currently not supported/allowed. There must be
exactly one per <code>[[script]]</code> section. If you want to perform the same action
at different times, just create multiple sections with the respective triggers.</p>
<p>The available trigger conditions are:</p>
<details>
  <summary>
  <code>run_on_playback_control</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_on_playback_control = "Stop"
action = "..."
</code></pre>
<p>Run the action at a special point in the script's playback lifecycle.
This is useful for performing initialization when the script starts and
cleanup when the script stops.</p>
<p>The available values are:</p>
<ul>
<li><code>"Start"</code>: whenever the current script asset is played (switched to)</li>
<li><code>"Stop"</code>: whenever the current script stops playing (incl. when switching to another script)</li>
</ul>
</details>
<details>
  <summary>
  <code>run_on_slot_enable</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_on_slot_enable = "MySlot"
action = "..."
</code></pre>
<p>Run the action whenever a specific <em>slot</em> is set to <code>true</code>.</p>
<p>This allows Rust code, etc., to control the script.</p>
</details>
<details>
  <summary>
  <code>run_on_slot_disable</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_on_slot_disable = "MySlot"
action = "..."
</code></pre>
<p>Run the action whenever a specific <em>slot</em> is set to <code>false</code>.</p>
<p>This allows Rust code, etc., to control the script.</p>
</details>
<details>
  <summary>
  <code>run_at_tick</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_at_tick = 96
action = "..."
</code></pre>
<p>Run the action once, on the given tick number.</p>
<p>Tick numbers count from the start of the script. May be affected by script settings.</p>
</details>
<details>
  <summary>
  <code>run_every_n_ticks</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_every_n_ticks = "16"
action = "..."

[[script]]
run_every_n_ticks = "12+8"
action = "..."
</code></pre>
<p>Run the action periodically, quantized to the given TickQuant value.</p>
<p>In the example above:</p>
<ul>
<li>the first action will run on ticks 0, 16, 32, 48, 64, 80, ...</li>
<li>the second action will run on ticks 8, 20, 32, 44, 56, 68 ...</li>
</ul>
<p>Does not catch up on missed time (if the <code>time_base</code> setting is not <code>Relative</code>).</p>
</details>
<details>
  <summary>
  <code>run_at_millis</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_at_millis = 250
action = "..."
</code></pre>
<p>Run the action once, after the given number of milliseconds have elapsed.</p>
<p>Time is counted from the start of the script. Affected by the <code>time_base</code> setting.</p>
</details>
<details>
  <summary>
  <code>run_at_time</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_at_time = "1:13:17.315"
action = "..."
</code></pre>
<p>Run the action once, after the given amount of time has elapsed.</p>
<p>Time is counted from the start of the script. Affected by the <code>time_base</code> setting.</p>
<p>The syntax for the time allows you to specify: hours, minutes, seconds, fraction
of the second. Everything except for the seconds is optional. Minutes/seconds
over 60 are accepted. Leading zeros are optional.</p>
<p>Examples:</p>
<ul>
<li><code>"10"</code>: 10 seconds</li>
<li><code>"5:00"</code>: 5 minutes</li>
<li><code>1:00:05</code>: 1 hour, 5 seconds</li>
<li><code>1:7:5.25</code>: 1 hour, 7 minutes, 5.25 seconds</li>
<li><code>5:80</code>: 5 minutes + 80 seconds (effectively the same as <code>"6:20"</code>)</li>
</ul>
</details>
<h2 id="common-parameters-modifiers"><a class="header" href="#common-parameters-modifiers">Common Parameters (Modifiers)</a></h2>
<p>These are additional parameters that can be specified regardless of the action.</p>
<p>Whenever the trigger condition is met, these parameters will be evaluated. They
can be used to modify how the action should run or if it should run at all.</p>
<details>
  <summary>
  <code>rng_pct</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># At 5 minutes, there is a 15% chance of something happening
[[script]]
run_at_time = "5:00"
rng_pct = 15
action = "..."

# Every 360 ticks, there is a 50% chance of something happening
[[script]]
run_every_n_ticks = "360"
rng_pct = 50
</code></pre>
<p>Adds an element of randomness. Set the probability of whether the action should be run.</p>
<p>The value should be a number between <code>0.0</code> and <code>100.0</code>, indicating a percentage.</p>
</details>
<details>
  <summary>
  <code>delay_ticks</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># do something 5 ticks after "MySlot" becomes true
[[script]]
run_on_slot_enable = "MySlot"
delay_ticks = 5
action = "..."
</code></pre>
<p>Delays the action to happen a certain number of tick later, after the trigger
condition is hit.</p>
</details>
<details>
  <summary>
  <code>if_previous_script_key</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># do something special on startup but only if
# transitioning from "player.behavior.special"
[[script]]
run_on_playback_control = "Start"
if_previous_script_key = "player.behavior.special"
action = "..."
</code></pre>
<p>Only performs the action if a specific other script was running before this one.</p>
<p>This parameter allows you to implement special transitions, by making the current
script behave differently (perform different actions) depending on what
script preceded it.</p>
</details>
<details>
  <summary>
  <code>require_slots_all</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># do something at the 5-minute-mark, but only if
# the "ExtraDifficulty" and "FirstVisit" slots are set
[[script]]
run_at_time = "5:00"
require_slots_all = ["ExtraDifficulty", "FirstVisit"]
action = "..."
</code></pre>
<p>Checks the values of the specified slots and only performs the action if
all of them are <code>true</code>.</p>
</details>
<details>
  <summary>
  <code>require_slots_any</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># do something at the 5-minute-mark, but only if
# either "FullHealth" or "HealingAvailable" slots are set
[[script]]
run_at_time = "5:00"
require_slots_any = ["FullHealth", "HealingAvailable"]
action = "..."
</code></pre>
<p>Checks the values of the specified slots and only performs the action if
at least one them is <code>true</code>.</p>
</details>
<details>
  <summary>
  <code>forbid_slots_all</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># do something at the 5-minute-mark, but only if
# "FullHealth" and "HealingAvailable" slots are both false
[[script]]
run_at_time = "5:00"
forbid_slots_all = ["FullHealth", "HealingAvailable"]
action = "..."
</code></pre>
<p>Checks the values of the specified slots and only performs the action if
all of them are <code>false</code>.</p>
</details>
<details>
  <summary>
  <code>forbid_slots_any</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml"># do something at the 5-minute-mark, but only if
# neither of "BossDefeated" or "FirstVisit" slots are set
[[script]]
run_at_time = "5:00"
forbid_slots_any = ["BossDefeated", "FirstVisit"]
action = "..."
</code></pre>
<p>Checks the values of the specified slots and does not perform the action if
any of them is <code>true</code>.</p>
</details>
<h2 id="available-actions"><a class="header" href="#available-actions">Available Actions</a></h2>
<p>The action kind is a mandatory part of every <code>[[script]]</code> section. There must be
exactly one <code>action</code> field per section. If you want to perform more than one
action, create multiple sections (possibly with the same trigger condition).</p>
<p>Most actions accept/require additional parameters. Simply add those to the
<code>[[script]]</code> section, depending on the kind of action.</p>
<p>The available actions are:</p>
<details>
  <summary>
  <code>SlotEnable</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SlotEnable"
slot = "MySlot"
</code></pre>
<p>Sets the value of <code>slot</code> to <code>true</code>.</p>
</details>
<details>
  <summary>
  <code>SlotDisable</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SlotDisable"
slot = "MySlot"
</code></pre>
<p>Sets the value of <code>slot</code> to <code>false</code>.</p>
</details>
<details>
  <summary>
  <code>SlotToggle</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SlotToggle"
slot = "MySlot"
</code></pre>
<p>Sets the value of <code>slot</code> to the inverse of its current value.</p>
</details>
<details>
  <summary>
  <code>DespawnEntity</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "DespawnEntity"

[[script]]
action = "DespawnEntity"
label = "mythingies"
</code></pre>
<p>If the <code>label</code> field is not present, despawns the current entity (the one
hosting the script). This will cause the script to be terminated.</p>
<p>If the <code>label</code> field is present, will use the <a href="https://theseekergame.github.io/api/theseeker_engine/script/label/struct.EntityLabels.html"><code>EntityLabels</code></a> resource to find
all entities with the given label string and despawn them.</p>
</details>
<details>
  <summary>
  <code>RunCli</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "RunCli"
cli = [
  "hello",
]
</code></pre>
<p>Runs one or more <a href="tech/./cli-ref.html">CLI commands</a>, just like you can do manually
from the <a href="tech/./cli.html">dev console</a>.</p>
<p>Requires the <code>cli</code> field, which is a list of CLI strings to evaluate.</p>
<p>All of them will run on the same tick / script update, in order.</p>
</details>
<details>
  <summary>
  <code>SpawnScript</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SpawnScript"
asset_key = "script.asset.key"
</code></pre>
<p>Runs the given script asset. Will create a new Bevy entity for it.</p>
</details>
<div style="break-before: page; page-break-before: always;"></div><h1 id="animations-how-to"><a class="header" href="#animations-how-to">Animations How-To</a></h1>
<p>Animation Assets are how we create sprite-based animations.</p>
<p>Each such file is an animation that can be played by the game, and describes how
it should be played.</p>
<p>Animations are actually based on <a href="tech/./script.html">scripts</a>. They support everything
that scripts can do + additional features tailored for animation use cases.</p>
<p><a href="tech/./anim-ref.html">See here for a reference on the syntax/format.</a></p>
<h2 id="art-assets"><a class="header" href="#art-assets">Art Assets</a></h2>
<p>An animation consists of 3 parts:</p>
<ul>
<li>The "spritesheet image" (typically PNG format), which provides the actual
image data / frames to be displayed.</li>
<li>The "texture atlas layout": the metadata describing the dimensions of each
frame and the number of rows and columns in the spritesheet image.</li>
<li>The "animation script", which allows our animation system to play the animation
and allows extra features and Rust integrations to be hooked up to it.</li>
</ul>
<p>Normally, when you want to add a new animation to the game, you should declare
the above three things in <code>animations.assets.ron</code>. Example:</p>
<pre><code class="language-ron">    "anim.player.FallForward": File (
        path: "animations/player/movement/FallForward.anim.toml",
    ),
    "anim.player.FallForward.image": File (
        path: "animations/player/movement/FallForward.png",
    ),
    "anim.player.FallForward.atlas": TextureAtlasLayout (
        tile_size_x: 96.,
        tile_size_y: 96.,
        rows: 1,
        columns: 4,
    ),
</code></pre>
<p>The convention is to append <code>.image</code> and <code>.atlas</code> for the asset keys of
the spritesheet image and texture atlas layout, respectively.</p>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<p>To see how an animation looks in-game, you can test it using the <a href="tech/./cli.html">dev
console</a>. Use the <a href="tech/./cli-ref.html#spawn_anim"><code>spawn_anim</code></a> command:</p>
<pre><code>spawn_anim anim.asset.key
</code></pre>
<p>Or optionally with X/Y coordinates where to display it:</p>
<pre><code>spawn_anim anim.asset.key 100 200
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="animation-format-reference"><a class="header" href="#animation-format-reference">Animation Format Reference</a></h1>
<p>This page describes the syntax / file format for <a href="tech/./anim.html">Animation Assets</a>.</p>
<p>The animation format is based on the <a href="tech/./script-ref.html">script format</a>, with some
differences and extensions (additional functionality). Everything supported in
scripts is also supported in animations.</p>
<h2 id="how-animation-playback-works"><a class="header" href="#how-animation-playback-works">How Animation Playback Works</a></h2>
<p>Animations will automatically advance their frames at a fixed rate. All you have
to do is configure the start frame index, the max frame index, and the speed.</p>
<p>For animations that just play through, once, from start to finish, this is enough.</p>
<p>If you need any more advanced control (such as to make animations that loop or
skip frames), you can add <code>[[script]]</code> sections, using animation-specific
<a href="tech/anim-ref.html#available-actions">actions</a>.</p>
<h2 id="texture-atlas"><a class="header" href="#texture-atlas">Texture Atlas</a></h2>
<p>At the top of the file, before any other sections, you must specify the asset key
of the texture atlas to be used for the animation:</p>
<pre><code class="language-toml">atlas_asset_key = "anim.myanimation.sprite"
</code></pre>
<h2 id="settings-1"><a class="header" href="#settings-1">Settings</a></h2>
<p>The <code>[settings]</code> section is <em>required</em> in animation files.</p>
<p>The common parameters that are optional in <a href="tech/./script-ref.html#settings">scripts</a>
are also optional here, but there are additional animation-specific settings
that are required in every animation file.</p>
<p>Example:</p>
<pre><code class="language-toml">[settings]
ticks_per_frame = 8
frame_min = 0
frame_max = 7
frame_start = 0
</code></pre>
<p>The above example will create an animation that starts from frame index 0,
advances to the next frame automatically every 8 ticks, and ends after frame 7
is displayed.</p>
<p>This is perfectly sufficient for a basic animation that does not require any
additional behaviors (such as looping or scripts).</p>
<p>You can have an animation without any <code>[[script]]</code> sections.</p>
<h3 id="required-settings"><a class="header" href="#required-settings">Required Settings</a></h3>
<p>The following properties must be specified:</p>
<details>
  <summary>
  <code>ticks_per_frame</code>
  </summary>
<p>Configures the rate/speed of animation playback. This is how many ticks each frame
will be displayed for, before automatically transitioning to the next frame.</p>
</details>
<details>
  <summary>
  <code>frame_min</code>
  </summary>
<p>The lowest permitted frame index. Frames below this should never be displayed.
Should the frame index ever be a value below this, the animation will stop
automatically.</p>
</details>
<details>
  <summary>
  <code>frame_max</code>
  </summary>
<p>The highest permitted frame index. Frames above this should never be displayed.
Should the frame index ever be a value above this, the animation will stop
automatically.</p>
</details>
<details>
  <summary>
  <code>frame_start</code>
  </summary>
<p>The initial frame that will be displayed at tick 0 when the animation starts
playing.</p>
</details>
<h3 id="optional-settings"><a class="header" href="#optional-settings">Optional Settings</a></h3>
<p>The following additional properties may optionally be specified:</p>
<details>
  <summary>
  <code>atlas_asset_key</code>
  </summary>
<p>Use a specific texture atlas layout, instead of the default. Provide the asset key string.</p>
<p>The default is derived by appending <code>.atlas</code> to the asset key of this animation script
asset file.</p>
</details>
<details>
  <summary>
  <code>image_asset_key</code>
  </summary>
<p>Use a specific spritesheet image, instead of the default. Provide the asset key string.</p>
<p>The default is derived by appending <code>.image</code> to the asset key of this animation script
asset file.</p>
</details>
<h2 id="actions-1"><a class="header" href="#actions-1">Actions</a></h2>
<p>Just like a <a href="tech/./script-ref.html#actions">script file</a>, animations can contain any
number of <em>actions</em> to be performed. The syntax is the same.</p>
<p>All run conditions and actions available in scripts are also available in
animations, but animations also offer extra animation-specific ones.</p>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_at_tick = 24
action = "SetFrameNext"
frame_index = 20

[[script]]
run_at_frame = 7
action = "SetSpriteFlip"
flip_x = true
</code></pre>
<h2 id="available-run-conditions"><a class="header" href="#available-run-conditions">Available Run Conditions</a></h2>
<p>The following animation-specific run conditions are available, in addition to
everything supported by <a href="tech/./script-ref.html#available-run-conditions">scripts</a>:</p>
<details>
  <summary>
  <code>run_at_frame</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
run_at_frame = 8
action = "..."
</code></pre>
<p>Run the action whenever the given frame index is displayed.</p>
<p>Any time the animation switches to that frame (regardless of whether it was done
automatically, using a script, or from Rust code), the action will be performed.</p>
</details>
<h2 id="available-actions-1"><a class="header" href="#available-actions-1">Available Actions</a></h2>
<p>The following animation-specific actions are available, in addition to
everything supported by <a href="tech/./script-ref.html#available-actions">scripts</a>:</p>
<details>
  <summary>
  <code>SetFrameNext</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SetFrameNext"
frame_index = 100
</code></pre>
<p>Change the next automatic frame. Whatever frame is currently displayed will
complete its <code>ticks_per_frame</code> duration, and then the animation will jump to the
provided <code>frame_index</code>, instead of advancing by one.</p>
<p>Subsequent playback will continue from this new index (will not jump back).</p>
<p>This is useful to implement loops (by going back to a lower frame index) and
skips (if you need to jump over a range of frames).</p>
</details>
<details>
  <summary>
  <code>SetFrameNow</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SetFrameNow"
frame_index = 100
</code></pre>
<p>Immediately display the provided <code>frame_index</code>.</p>
<p>Does not affect the next automatic frame. The animation playback is otherwise unaffected.</p>
<p>Useful for special effects where you have a special frame you want to "flash"
in-between regular animation frames.</p>
</details>
<details>
  <summary>
  <code>SetSpriteColor</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SetSpriteColor"
color = "#ff00ff"

[[script]]
action = "SetSpriteColor"
color = [0.75, 0.5, 120.0]
</code></pre>
<p>Changes the colorization of the sprite. The RGBA values of the pixels will be
multiplied by the provided value.</p>
<p>The <code>color</code> field can be specified as either:</p>
<ul>
<li><code>[L, C, H]</code> for LCH color</li>
<li><code>[L, C, H, A]</code> for LCH color + Alpha</li>
<li><code>#RRGGBB</code> for RGB color</li>
<li><code>#RRGGBBAA</code> for RGB + Alpha</li>
</ul>
<p>RGB color is specified in hexadecimal notation, like for Web/CSS.</p>
<p>LCH color is specified as:</p>
<ul>
<li>Lightness has range 0.0 to 1.5</li>
<li>Chroma has range 0.0 to 1.5</li>
<li>Hue has range 0.0 to 360.0 (degrees)</li>
</ul>
</details>
<details>
  <summary>
  <code>SetSpriteFlip</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SetSpriteFlip"
flip_x = true
flip_y = true
</code></pre>
<p>Changes whether the sprite image should be displayed flipped/mirrored, along
either axis, or both axes.</p>
<p>Each of the <code>flip_x</code> and <code>flip_y</code> fields are optional. If omitted, the old
value will be kept.</p>
<p>Useful for making left/right facing animations from the same texture atlas.</p>
</details>
<details>
  <summary>
  <code>SetTicksPerFrame</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "SetTicksPerFrame"
ticks_per_frame = 4
</code></pre>
<p>Changes the rate of animation playback.</p>
<p>Useful if you want to use a different rate (from what you specified globally in
the <a href="tech/anim-ref.html#settings">settings</a>) for some portion of the animation.</p>
</details>
<details>
  <summary>
  <code>TransformMove</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformMove"
x = "2.0"
y = "1.0"
z = "0.0"
</code></pre>
<p>Relative move. Cause the sprite entity's Transform to be translated by the given values.</p>
<p>Each of the <code>x</code>, <code>y</code>, <code>z</code> fields are optional. Omit those you want to leave untouched.</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>
<details>
  <summary>
  <code>TransformTeleport</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformTeleport"
x = "2.0"
y = "1.0"
z = "5.0"
</code></pre>
<p>Teleport the entity to the given position. Set the sprite entity's Transform's translation to the given values.</p>
<p>The <code>z</code> field is optional. <code>x</code> and <code>y</code> are required.</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>
<details>
  <summary>
  <code>TransformSetScale</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformSetScale"
x = "2.0"
y = "1.0"
</code></pre>
<p>Set the scale that the sprite should be displayed as.</p>
<p>Both <code>x</code> and <code>y</code> are required.</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>
<details>
  <summary>
  <code>TransformRotateTurns</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformRotateTurns"
turns = "-1/4"
</code></pre>
<p>Rotate the sprite by N turns. 1 turn = 360 degrees.</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>
<details>
  <summary>
  <code>TransformRotateDegrees</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformRotateDegrees"
degrees = "-15.0"
</code></pre>
<p>Rotate the sprite by N degrees.</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>
<details>
  <summary>
  <code>TransformSetRotationTurns</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformSetRotationTurns"
turns = "-1/4"
</code></pre>
<p>Set the sprite's rotation to a specific value (in turns). 1 turn = 360 degrees.</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>
<details>
  <summary>
  <code>TransformSetRotationDegrees</code>
  </summary>
<p>Example:</p>
<pre><code class="language-toml">[[script]]
action = "TransformSetRotationDegrees"
degrees = "-15.0"
</code></pre>
<p>Set the sprite's rotation to a specific value (in degrees).</p>
<p>The values must be in quotes and can be specified as either:</p>
<ul>
<li>decimal syntax, like: <code>"1.25"</code></li>
<li>fraction syntax, like: <code>"5/4"</code></li>
</ul>
</details>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
